To take advantage of multirate processing extra octave bands have been added, see \autoref{tb:filterBands}, increasing the number of downsamples which results in the following bands given in \autoref{tb:filterBands} and seen in \autoref{fig:allBands}.
\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
       & f1 {[}Hz{]} & fm {[}Hz{]} & f2 {[}Hz{]} \\ \hline
Band 7 & 2121        & 3000        & 4243        \\ \hline
Band 6 & 1061        & 1500        & 2121        \\ \hline
Band 5 & 530,3       & 750         & 1061        \\ \hline
Band 4 & 265,2       & 375         & 530,3       \\ \hline
Band 3 & 132,6       & 187,5       & 265,2       \\ \hline
Band 2 & 66,29       & 93,75       & 132,6       \\ \hline
Band 1 & 33,15       & 46,87       & 66,29       \\ \hline
\end{tabular}
\caption{Bands}
\label{tb:filterBands}
\end{table}   

\begin{figure}[H]
	\centering
	\tikzsetnextfilename{allBands}
	\input{figures/allBands.tex}
	\caption{Overview of all band requirements}
	\label{fig:allBands}
\end{figure}
The reason for downsampling seven times and not more or less is because of several reasons. Firstly the bandwidth of the decimation filter must not be influenced by the interpolation filter which would give a non flat frequency response so every band is set to have a center frequency 1/16 of Fs, secondly the lower the center frequency in relation to Fs the higher the filter order which is desired as low as possible, lastly increasing the number of downsamples increases the delay of the system which is not desired in relation to real time applications.       
\todo[inline]{Skal det være mere begrundet? skal vi skrive at det er baseret på trial and error senere i forløbet?}

Because there will be downsampled by two for every octave band the following relation can be made between a band and Fs as seen on \autoref{fig:relFsBand}.
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{relativeFsBand}
	\input{figures/relativeFsBand.tex}
	\caption{Band relative to Fs}
	\label{fig:relFsBand}
\end{figure}

From \autoref{fig:relFsBand} two points are selected giving the following specifications to the lowpass filter:

$\omega_{pass}=3.000\textrm{ Hz }\cdot 2/Fs=0.1250 \enhed{rad/sample}$\\
$A_{pass}=-1 \enhed{dB}$\\
$\omega_{stop}=6.500\textrm{ Hz }\cdot 2/Fs=0.2708 \enhed{rad/sample}$\\
$A_{stop}=-60 \enhed{dB}$

The design method used for designing the filter is the Kaiser window method, explained in detail in \autoref{app:FIR_theory}. The reason for using the Kaiser window method is that it gives the approximate order of the filter and the beta value of the window applied to impulse reponse. This means that no trial and error method is needed to meet the requierments of the filter.

With the specification stated and using the matlab script explained in \autoref{app:FIR_Matlab} which uses the FIR theoy explained in \autoref{app:FIR_theory} about the Kaiser window method, general FIR theory and deriving the coefficients of the filter, the following filter is given with quantisized coefficients, see \autoref{fig:band1_filt} for magnitude response and \autoref{fig:band1_filtPhase} for phase response. The order of the filter is 50, it is a type 1 FIR filter and has linear phase which means that the group delay is constant at 25 samples.  

\begin{figure}[H]
\centering
	\tikzsetnextfilename{Band1Filt}
	\input{figures/Band1Filt.tex}
	\caption{Calculated filter magnitude response with requirements.}
	\label{fig:band1_filt}
\end{figure}
\begin{figure}[H]
\centering
	\tikzsetnextfilename{Band1Phase}
	\input{figures/Band1Phase.tex}
	\caption{Calculated filter phase response.}
	\label{fig:band1_filtPhase}
\end{figure}

From \autoref{fig:band1_filt} it can be concluded that the filter meets the band requirements and has a constant group delay which means that spectral subtraction can be made from the output. This concludes the decimation filter. 

\section{Interpolation filter}
The interpolation filter as mentioned before must be designed so it does not influence the bandwidth of the decimated signal therefore the passband of the interpolation filter must be larger than stopband of the decimation filter. This means that the passband of the filter must be above 0.3 rad/sample, while there must be an attenuation of minimum 60 dB at 1 rad/sample (Fs/2). From these demands the following demands are set for the interpolation filter
\todo[inline]{Oppenheim reference}

$\omega_{pass}=0,3 \enhed{rad/sample}$\\
$A_{pass}=0 \enhed{dB}$\\
$\omega_{pass}=1 \enhed{rad/sample}$\\
$A_{pass}=-60 \enhed{dB}$

A buffer is given to both $\omega_{pass}$ and $\omega_{stop}$ because of quantization, so the following requirements are set for the filter.

$\omega_{pass}=0,3 \enhed{rad/sample}$\\
$A_{pass}=0 \enhed{dB}$\\
$\omega_{pass}=0,8 \enhed{rad/sample}$\\
$A_{pass}=-60 \enhed{dB}$

 If the kaiser window method is used and the same FIR theory and matlab script is used as with the decimatino filter the following filter is given with quatisized coefficient, see for magnitude response and for phase response. The order of the filter is XX, it is a type 1 FIR filter and has linear phase with a group delay of XX samples.

\todo[inline]{Magnitude response figure}

\todo[inline]{Phase response figure}

From XX it can be verified that the filter meets the requirements sat up for the filter. It is seen that the interpolation filter does not attenuate before after the stopband bandwidth of the decimation filter (0,3 rad/sample) and has an attenuation of at least 60 dB at 1 rad/sample. On XX the decimation filter and interpolation filter´s magnitude response is seen.  

\todo[inline]{Magnitude response figure of decimation and interpolation filter}

The decimation and interpolation filter is now designed with quantisized values. The implementation of the filters can be seen in XX.    