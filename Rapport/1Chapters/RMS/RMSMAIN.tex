\chapter{RMS Compressor}\label{cha:CompressorDesign}
This chapter will cover the design thoughts and considerations in designing the RMS compressor which will be used to suppress to large amplitude levels in the lower frequencies. 
\vspace{2mm}
From \autoref{app:journal_speaker_test2} It showed that the THD of the speaker increased as the amplitude is increased. It can be shown from figure \autoref{fig:com_micALLRMS} that the amplitude difference of the second and third harmonic has a decay correlating with an exponential decay. From these measurements it is possible to determine a given threshold were the speaker will perform with optimum conditions. 



\begin{figure}[H]
\begin{subfigure}[t]{0.45\textwidth}
    \centering
    \tikzsetnextfilename{comp_mic12AllRMS}
    \input{figures/comp_mic12AllRMS.tex}
    \caption{1.harmonic / 2.harmonic pr. measurement. comparison for all frequencies}
\label{fig:com_mic12AllRMS}
\end{subfigure}
\hspace{3mm}
\begin{subfigure}[t]{0.45\textwidth}
    \centering
    \tikzsetnextfilename{comp_mic13AllRMS}
    \input{figures/comp_mic13AllRMS.tex}
    \caption{1.harmonic / 3.harmonic pr. measurement. comparison for all frequencies}
\label{fig:com_mic13AllRMS}
\end{subfigure}
\caption{Comparison of amplitude level of the fundamental, sceond and third harmoinc.}
\label{fig:com_micALLRMS}
\end{figure}

In order to decrease to signal level in the lower bands a compressor will be used. The compressor will be utilizing an calculated RMS value to determine whether an attenuation should be applied. It is hence important to determine how much attenuation should be applied and how fast it should be applied. To determine how much attenuation there will be conducted trails to locate the must problematic frequencies and determine gain models, this is documented in \autoref{app:journal_speaker_test3}. From the models the needed attenuation is determined. This is further described in the following section


\input{1Chapters/RMS/Model.tex}

\input{1Chapters/RMS/Design.tex}

%\input{1Chapters/RMS/Simulation.tex}