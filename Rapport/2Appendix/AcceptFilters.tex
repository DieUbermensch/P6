\chapter{Accepttest of decimation and interpolation filter}\label{app:journal_decimationFilter}
The purpose of these tests is to test the designed decimation filter to verify if the magnitude response and the phase response of the bands complies with class 2 of IEC 6964 standard (2001). The requirement for the interpolation filter is that it must not affect the bandwidth of the decimation signal.


\section{Setup}
The setup of this test are depicted in \autoref{fig:AcceptDec}, where the equipment is catalogued in \autoref{tab:UsedEquipmentDecimation}, and described as follows:

\begin{itemize}\addtolength{\itemsep}{-.35\baselineskip} 
\item Magnitude response and phase response will be measured with a NI-4461 based audio analyser. 
\begin{itemize}\addtolength{\itemsep}{-.35\baselineskip} 
\item Sampling frequency: 48000 Hz.
\item Generator amplitude: 0.5 V.
\item Frequency sweep: 20 Hz - 20000 Hz.
\end{itemize}
\item The software of the system used for the test is found at CD. \path{CD://Software/SystemFinal}
\item The software is modified to only run the first decimation and interpolation filter.
\end{itemize}


\subsection*{Test Setup}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{AcceptDec.png}
\caption{Test setup for decimation and interpolation filters}
\label{fig:AcceptDec}
\end{figure}

\subsection*{Equipment used and AAU-no.}

\begin{table}[H]
\centering
\ra{1.3}
\begin{tabular}{S[table-format=1]ccc} \toprule
    {Item} & {Description} & {AAU-no} \\ \bottomrule 
    1      &  NI-4461 based audio analyser  & 64640  \\ 
    2      &  TMS320C5515 eZdsp  & NaN  \\  \bottomrule 
\end{tabular}
\caption{Table over equipment used in the test}
\label{tab:UsedEquipmentDecimation}
\end{table}
\vspace{-5mm}


\section{Procedure}
The procedure for this experiment is described as follows:
\vspace{-5mm}
\begin{enumerate}\addtolength{\itemsep}{-.35\baselineskip} 
\item Setup the NI-4461 based audio analyser with the mentioned settings.
\item Setup the system with the correct software as described based on which filter is tested.
\item Start the sine sweep test.
\end{enumerate}

\section{Data Extraction}
The raw data can be found on CD for decimation filter data, and interpolation filter data on CD, \\
\path{CD://Maalinger/Maalinger220516 - Acceptance test for Interpolation and Decimation}   \\ 
The following raw data logged during the experiment:
\vspace{-5mm}
\begin{itemize}\addtolength{\itemsep}{-.35\baselineskip} 
\item Frequency [Hz]
\item Amplitude [dB]
\item Phase 	[deg]
\item THD 		[dB]
%\item HD 2 		[dB ref fund]
%\item HD 3		[dB ref fund]
%\item HD 4      [dB ref fund]
%\item HD 5      [dB ref fund]
\end{itemize} 
Which is extracted using the MATLAB script found on CD, \\
\path{CD://Maalinger/Maalinger220516 - Acceptance test for Interpolation and Decimation/File.mat},  \\
and gives the magnitude and phase response of the filter.
\section{Analysis}
To analyse the result, both phase and gain is plotted along with the needed requirements. It should be noted that the phase makes a shift at every 180 degrees. This is automatically done in the NI-4461. With this is mind is shows a linear phase.

\subsection*{Decimation filter}
It is seen in \autoref{fig:AcceptDec} that the filter meets the requirements. It is also seen in figure \autoref{fig:AcceptDecPhase} that the filter has linear phase which gives a constant group delay in up until the stop-band which meets the requirement of linear phase. 
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{acceptDecMag}
	\input{figures/acceptDecMag.tex}
	\caption{Decimation magnitude response with requirements.}
	\label{fig:acceptDecMag}
\end{figure}
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{acceptDecPhase}
	\input{figures/acceptDecPhase.tex}
	\caption{Decimation phase response.}
	\label{fig:AcceptDecPhase}
\end{figure}


\subsection*{Interpolation filter}

\begin{figure}[H]
	\centering
	\tikzsetnextfilename{acceptIntMag}
	\input{figures/acceptIntMag.tex}
	\caption{Decimation magnitude response with requirements.}
	\label{fig:acceptIntMag}
\end{figure}
\begin{figure}[H]
	\centering
	\tikzsetnextfilename{acceptIntPhase}
	\input{figures/acceptIntPhase.tex}
	\caption{Decimation Phase response .}
	\label{fig:AcceptIntPhase}
\end{figure}

\section{Error sources}
The generator on the NI-4461 card has a deviation of $\pm$ 0,008 dB from 20 Hz - 20 kHz. The analyser on the NI-4461 card has a deviation of : $\pm$ 0,08 dB from 20 Hz - 92 kHz. If the delayed input signal is not completely in phase with the output signal from the system, the frequency response will not be measured correct.

\section{Conclusion}
It can be concluded from the two test that both filters meet their respective requirements. They both attenuate enough and have a linear phase with a constant group delay.